var categories = {
  SummerReview: [
    { word: "une victoire écrasante", translation: "an overwhelming victory" },
    { word: "demandeur d’asile", translation: "asylum seeker" },
    { word: "être blessé", translation: "to be injured" },
    { word: "incendie volontaire", translation: "arson" },
    { word: "la foule", translation: "the crowd" },
    {
      word: "le film le plus rentable",
      translation: "the most profitable film",
    },
    { word: "un visage ensanglanté", translation: "a bloodied face" },
    { word: "la brasse", translation: "the breaststroke" },
    { word: "mérité", translation: "deserved" },
    { word: "coincés dans l’espace", translation: "stuck in space" },
    { word: "s’excuser", translation: "to apologize" },
    { word: "une antenne parabolique", translation: "a satellite dish" },
    { word: "une perturbation", translation: "a disturbance" },
    { word: "une échelle", translation: "a ladder" },
    { word: "avoir lieu", translation: "to take place" },
    { word: "une ville balnéaire", translation: "a seaside town" },
    { word: "des émeutes", translation: "riots" },
    { word: "menacés", translation: "threatened" },
  ],
  SummerReview2A: [
    { word: "Somptueux", translation: "sumptuous" },
    { word: "Viser", translation: "to aim" },
    { word: "Ex- / ancien(-ne)", translation: "former" },
    { word: "Coûteux", translation: "costly" },
    { word: "Décennie", translation: "decade" },
    { word: "Colère", translation: "anger" },
    { word: "Feux de forêt", translation: "wildfires" },
    { word: "Émeutier (une émeute)", translation: "rioter (a riot)" },
    { word: "Réchauffement climatique", translation: "global warming" },
    {
      word: "Une sortie (film, disque…)",
      translation: "a release (film, record…)",
    },
    { word: "Augmentation", translation: "increase" },
    { word: "Éloge, louange", translation: "praise" },
    { word: "Sauveteur (secourir)", translation: "rescuer (to rescue)" },
    { word: "Étendu, répandu", translation: "widespread" },
    { word: "Épave", translation: "wreck" },
    { word: "Rester", translation: "to stay" },
    { word: "Selon, d’après", translation: "according to" },
    { word: "Vague de chaleur", translation: "heatwave" },
  ],
  EventsSummer2024: [
    {
      word: "July 5th: Keir Starmer becomes Prime Minister",
      translation:
        "Keir Starmer succeeded Rishi Sunak following the 2024 general election in Britain. He emphasized the challenge of fixing a wounded country.",
    },
    {
      word: "July 13th: Donald Trump Assassination Attempt",
      translation:
        "Donald Trump was injured during an attempted assassination at a rally in Pennsylvania, resulting in his injury and the death of the gunman.",
    },
    {
      word: "July 15th: Spain Wins Euro 2024",
      translation:
        "Spain defeated England 2-1 in the European Football Championship, claiming its fourth title and breaking records for goals scored.",
    },
    {
      word: "July 19th: Global IT Outage",
      translation:
        "A faulty software update by CrowdStrike caused a global IT outage, affecting businesses, banks, and hospitals, and led to widespread disruption.",
    },
    {
      word: "July 22nd: Biden Declines Reelection",
      translation:
        "President Joe Biden announced he will not seek reelection and endorsed Kamala Harris, shaking up the political landscape.",
    },
    {
      word: "July 24th: Paris 2024 Summer Olympics",
      translation:
        "The 2024 Summer Olympics, held in Paris and other cities across France, kicked off on July 24.",
    },
    {
      word: "July 30th: Far-Right Riots in England",
      translation:
        "Far-right riots broke out in England following a mass stabbing, which was falsely blamed on a Muslim asylum seeker.",
    },
    {
      word: "July 31st: Inside Out 2 Becomes Highest-Grossing Animated Film",
      translation:
        "Inside Out 2 earned $1.46 billion, surpassing Frozen II to become the highest-grossing animated film of all time.",
    },
    {
      word: "August 2nd: Léon Marchand Wins Fourth Olympic Gold",
      translation:
        "French swimmer Léon Marchand won his fourth gold medal at the 2024 Summer Olympics, cementing his place in swimming history.",
    },
    {
      word: "August 7th: Astronauts Stranded in Space",
      translation:
        "Two astronauts may be stranded aboard the ISS until 2025 due to safety concerns.",
    },
    {
      word: "August 9th: Banksy Artwork Stolen",
      translation:
        "A new Banksy artwork depicting a wolf on a satellite dish in London was stolen shortly after it was unveiled.",
    },
    {
      word: "August 13th: Greek Wildfires",
      translation:
        "Wildfires continued to ravage Greece, prompting evacuation alerts and assistance from European nations.",
    },
  ],
  EventsSummer20242A: [
    {
      word: "May 6th: Coronation of King Charles III",
      translation:
        "King Charles III and Queen Consort Camilla were crowned in a lavish coronation ceremony, the first in over 70 years following Queen Elizabeth II's death in 2022.",
    },
    {
      word: "June 3rd: Indian Train Crash",
      translation:
        "A train crash in eastern India killed more than 270 people, marking the country's worst disaster in two decades.",
    },
    {
      word: "June: Canadian Wildfire Smoke Over New York",
      translation:
        "Smoke from Canadian wildfires covered parts of the eastern U.S., turning the sky orange over New York City, with climate change cited as a major factor.",
    },
    {
      word: "June 9th: Children Found After 40 Days in the Jungle",
      translation:
        "Four children were found alive after surviving a plane crash and spending 40 days in the Colombian rainforest.",
    },
    {
      word: "June 22nd: Titanic Submarine Catastrophe",
      translation:
        "The search for five people aboard a submarine viewing the Titanic wreckage ended in tragedy, as pieces of the vessel were found after a 'catastrophic implosion'.",
    },
    {
      word: "June 23rd: Russian Military Mutiny",
      translation:
        "Yevgeny Prigozhin, a Russian military leader, mounted an armed insurrection against the Kremlin's military leadership.",
    },
    {
      word: "July 2nd: Riots in France",
      translation:
        "Violent protests erupted in France after the police killing of 17-year-old Nahel M., leading to riots and attacks on local politicians.",
    },
    {
      word: "July 21st: Barbie and Oppenheimer Released",
      translation:
        "Barbie was released, sparking the 'Barbenheimer' phenomenon, and became the highest-grossing film directed by a woman.",
    },
    {
      word: "August 8th: Maui Wildfires",
      translation:
        "Wildfires on the island of Maui, Hawaii, caused widespread destruction and claimed the lives of at least 114 people, with around 1,300 still missing in the aftermath.",
    },
    {
      word: "August 14th: Donald Trump Indicted in Georgia",
      translation:
        "Former President Donald Trump faced significant legal charges in Georgia, where he was accused of attempting to reverse the results of the 2020 election.",
    },
    {
      word: "August 20th: Spain Wins Women's World Cup",
      translation:
        "Spain won their first-ever Women's World Cup title, defeating England 1-0 in the final with a goal from Olga Carmona.",
    },
    {
      word: "Summer 2023: Record Heatwaves",
      translation:
        "The summer of 2023 saw the warmest temperatures on record, with extreme heatwaves sweeping across Europe, China, and North America.",
    },
  ],
};

var category = "all";
var index = 0;
var mode = "word";
var lastWord = null;
var originalWords = [];
var percentageShown = 0;
var shownWords = [];

function changeCategory() {
  category = document.getElementById("category").value;
  index = 0;
  shuffleButtonClickCount = 0; // Reset the shuffle button click count
  if (category == "all") {
    words = [].concat(
      categories.SummerReview,
      categories.SummerReview2A,
      categories.EventsSummer2024,
      categories.EventsSummer20242A
    );
  } else {
    words = categories[category];
  }
  originalWords = words.slice();
  words = originalWords.slice();

  shownWords = [];

  displayWord();

  // Update total number of words in the selected category
  var totalWords = document.getElementById("total");
  totalWords.innerText = "Total words in category: " + originalWords.length;
}

function displayWord() {
  var word = null;
  var translation = null;

  if (words.length === 0) {
    document.getElementById("summary").innerText = "All words have been shown!";
    document.getElementById("details").innerText = "";
    return;
  }

  do {
    index = Math.floor(Math.random() * words.length);
    word = words[index].word;
    translation = words[index].translation;
  } while (word === lastWord);

  currentWord = word;
  currentTranslation = translation;

  // Display the current word and translation without shuffling
  displayCurrentWord();

  // Remove the shown word from the words array
  words.splice(index, 1);

  percentageShown =
    ((originalWords.length - words.length) / originalWords.length) * 100;
  var percentage = document.getElementById("percentage");
  percentage.innerText =
    "Percentage of words shown from the selected category: " +
    percentageShown.toFixed(2) +
    "%";
}

var currentWord = null;
var currentTranslation = null;

function switchWord() {
  if (mode == "word") {
    mode = "translation";
  } else {
    mode = "word";
  }

  // Display the current word and translation without shuffling
  displayCurrentWord();
}

function displayCurrentWord() {
  var summary = document.getElementById("summary");
  var details = document.getElementById("details");
  var status = document.getElementById("status");

  if (mode == "word") {
    summary.innerText = currentWord;
    details.innerText = currentTranslation;
    status.innerText = "Showing up right now: Word (English)";
  } else {
    summary.innerText = currentTranslation;
    details.innerText = currentWord;
    status.innerText = "Showing up right now: Translation (French)";
  }
}

var shuffleButton = document.getElementById("shuffleButton");
var shuffleButtonClickCount = 0;

function shuffleWord() {
  shuffleButtonClickCount++;

  if (shuffleButtonClickCount === originalWords.length) {
    // If shuffle button clicked x+1 times (where x is the number of words in the category), show congrats screen
    document.getElementById("congratsScreen").style.display = "block";
    return;
  }

  // Shuffle the words in the words array
  for (var i = words.length - 1; i > 0; i--) {
    var j = Math.floor(Math.random() * (i + 1));
    var temp = words[i];
    words[i] = words[j];
    words[j] = temp;
  }

  index = 0;

  displayWord();
}

window.onload = changeCategory;

document.addEventListener("DOMContentLoaded", function () {
  const toggle = document.querySelector("#switch");

  // Check the user's preferred color scheme
  const preferredTheme = window.matchMedia("(prefers-color-scheme: dark)")
    .matches
    ? "dark"
    : "light";

  // If there's a saved theme, use that instead
  const currentTheme = localStorage.getItem("theme") || preferredTheme;
  document.documentElement.setAttribute("data-theme", currentTheme);

  if (currentTheme === "dark") {
    toggle.checked = true;
  } else {
    toggle.checked = false;
  }

  toggle.addEventListener("change", function () {
    if (this.checked) {
      document.documentElement.setAttribute("data-theme", "dark");
      localStorage.setItem("theme", "dark"); // Save the choice in localStorage
    } else {
      document.documentElement.setAttribute("data-theme", "light");
      localStorage.setItem("theme", "light"); // Save the choice in localStorage
    }
  });
});
